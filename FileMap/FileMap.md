# FileMap

这段Python代码定义了一个名为`FileMap`的类，旨在实现多线程下的文件搜索功能，特别是在指定的根目录及其子目录中，根据正则表达式匹配文件名。下面是代码各部分的详细解释：

1. **导入模块**：
   - `os`: 提供操作系统接口，用于文件和目录操作。
   - `threading`: 多线程编程模块，支持创建和管理线程。
   - `queue`: 实现线程安全的队列，用于线程间通信。
   - `time`: 时间相关的函数，这里用于延时。
   - `re`: 正则表达式模块，用于文本匹配。

2. **类定义**：
   - `FileMap`类有两个类变量：`file_path_dict`用于存储匹配到的文件路径，`root_path_list`存储需要搜索的根目录路径列表。
   
3. **初始化方法** `__init__`：
   - 接收一个参数`rood_path`（疑似笔误，应为`root_path`），并将其赋值给类变量`root_path_list`。

4. **方法 `task_center`**：
   - 负责协调整个文件搜索任务的流程，包括创建线程、启动线程、分配任务和停止线程。

5. **方法 `create_thread`**：
   - 创建两个队列（`task_queue_in_q`, `search_file_in_q`）和两个线程（处理任务队列的线程和执行文件搜索的线程），并将它们组织成字典返回。

6. **方法 `start_thread`**：
   - 遍历线程字典并启动每个线程。

7. **方法 `stop_thread`**：
   - 等待所有任务完成（通过检查队列中的任务数量是否为零），然后向队列发送"stop"信号来终止线程，并等待线程结束。

8. **方法 `search_file`**（文件搜索线程执行的方法）：
   - 从输入队列获取任务，如果任务为"stop"则退出循环；否则，根据任务中的正则表达式在相应目录下搜索匹配的文件，并将结果存入`file_path_dict`。对于遇到的每个子目录，构造新的任务（包含目录路径和原正则表达式）放入输出队列供后续处理。

9. **方法 `task_queue`**（任务队列线程执行的方法）：
   - 从输入队列获取任务，如果是"stop"则退出循环；否则，检查任务是否含有正则表达式，如果没有则默认使用匹配任何字符串的正则表达式，然后将处理后的任务放入输出队列，供`search_file`线程进一步处理。

整体上，这个程序设计为多线程并发地在多个根目录下递归搜索文件，利用正则表达式筛选出符合特定条件的文件，并记录这些文件的完整路径。通过队列实现了线程间的任务传递与同步控制，确保了程序的高效执行。